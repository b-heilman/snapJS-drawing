/*! snapJS 2013-11-06 */
!function(){"use strict";String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(this),function(a,b,c){"use strict";function d(a){console&&console.log&&(console.log(a),console.trace())}function e(){}function f(){this.args=arguments}function g(){}var h=document.getElementsByTagName("script"),i=h[h.length-1],j={},k={templator:["bmoor","templating","JQote"],templatorTag:"#",jsRoot:i.hasAttribute("root")?i.getAttribute("root"):i.getAttribute("src").match(/^(.*)\/b[Mm]oor(\.min)?\.js/)[1]},l={parse:function(a){return a?"string"==typeof a?a.split("."):a.length?a.slice(0):a:[]},get:function(a,c){var d,e,f=b;if(a&&("string"==typeof a||a.length)){a=this.parse(a),c&&(d=a.length-1,e=a[d],a[d]=e.charAt(0).toLowerCase()+e.slice(1));for(var g=0;g<a.length;g++){var h=a[g];f[h]||(f[h]={}),f=f[h]}}return f},exists:function(a,c){var d,e,f=b;if(a){if("string"==typeof a||a.length){a=this.parse(a),c&&(d=a.length-1,e=a[d],a[d]=e.charAt(0).toLowerCase()+e.slice(1));for(var g=0;g<a.length;g++){var h=a[g];if(!f[h])return null;f=f[h]}return f}return a}return null}},m={requests:0,onReady:[]};!function(){var a={},b={};m.parseResource=function(a){var b=a.match(/^(.*)\/(js|src)/);return b?b[1]:a.match(/^[js|src]/)?null:null},m.reset=function(){b={".":{fullName:!1},">":this.parseResource(k.jsRoot),"/":k.jsRoot,jquery:{"/":k.jsRoot+"/jquery",".":{fullName:!0}}}},m.reset(),m.setRoot=function(a){b["/"]=a,b[">"]=this.parseResource(a)},m.setLibrary=function(a,d,e,f){var g=b,h=l.parse(a);for(e||(e={});h.length;){var i=h.shift();g[i]===c&&(g[i]={}),g=g[i]}g["/"]=d,g["."]=e,g["*"]=f===!0,g[">"]=this.parseResource(d)},m.delLibrary=function(a){for(var c=b,d=null,e=null,f=l.parse(a);f.length&&c;){var g=f.shift();c[g]?(d=c,e=g,c=c[e]):c=null}c&&delete d[e]},m.getLibrary=function(a,c){for(var d=b,e=b,f=l.parse(a),g=c?null:f.pop(),h=f.slice(0);f.length;){var i=f[0];if(!d[i])break;d=d[f.shift()],d["/"]&&(e=d,h=f.slice(0))}return e["*"]?{root:e["/"],path:[],name:g,settings:e["."],resource:e[">"]}:{root:e["/"],path:h,name:g,settings:e["."],resource:e[">"]}},m.loadSpace=function(b,f,g,h,i){function j(){i===c&&(i={}),h===c&&(h=[]),g.apply(i,h)}function k(a){var c=l.exists(b);!c||c instanceof e||c.prototype&&c.prototype.__defining?setTimeout(k,10):g?(clearTimeout(a),j()):clearTimeout(a)}var m;if(b=l.parse(b),"function"==typeof f?(i=h,h=g,g=f,f=b):f||(f=b),m=l.exists(b))m instanceof e?k():j();else{var n=this.getLibrary(f),o=n.root+(n.path.length?"/"+n.path.join("/"):"")+"/"+(n.settings.fullName?f.join("."):n.name),p=function(c){var e,f,g,h=a[o];for(e=setTimeout(function(){l.exists(b)||d("loaded file : "+c+"\n but no class : "+b.join("."))},5e3),f=0,g=h.length;g>f;f++)h[f](e);a[o]=!0};a[o]?a[o].push(k):"boolean"==typeof a[o]?k():(a[o]=[k],bMoor.module.Resource.loadScriptSet(o+".js",o+".min.js",p))}},m.done=function(a){0===this.requests?a():this.onReady.push(a)},m.require=function(a,b,c){function d(){var a,c,d,e,f=[];if(m--,0===m){for(k.requests--,m--,c=0,a=p,d=a?a.length:0;d>c;c++)f.push(l.get(a[c]));if(b.apply({},f),0===k.requests){for(;k.onReady.length;)e=k.onReady.shift(),e();k.onReady=[]}}}var e,f,g,h,i,j,k=this,m=1,n=null,o=null,p=null;for(a.substring?(o=p=[a],n={}):a.length?(o=p=a,n={}):(n=a.references?a.references:{},o=a.classes?a.classes:[],p=a.aliases?a.aliases:[]),this.requests++,i=0,h=o,j=h?h.length:0;j>i;i++)f=l.parse(h[i]),m++,this.loadSpace(f,d);for(g in n)f=l.parse(g),m++,this.loadSpace(f,n[g],d);if(a.scripts&&(m++,bMoor.module.Resource.loadScript(a.scripts,d,c?c+"/js/":"js/")),a.styles)for(g in a.styles)m++,e=a.styles[g],"/"!=e.charAt(0)&&(e=c?c+"/css/"+e:"css/"+e),bMoor.module.Resource.loadStyle(e,d);if(a.templates)for(g in a.templates)m++,e=a.templates[g],"/"!=e.charAt(0)&&(e=c?c+"/template/"+e:"template/"+e),bMoor.module.Resource.loadScript(e,d);d()}}(),function(){function c(a,b,c){var d=typeof c,e=b[a];"function"==d?b[a]=function(){var a,b=this._wrapped;return this._wrapped=e,a=c.apply(this,arguments),this._wrapped=b,a}:"string"==d&&(b[a]+=" "+c)}function d(a,c,d){var e=c.parent?l.get(c.parent):null,f=c.namespace?l.parse(c.namespace):[],g=c.namespace?l.get(f):b;if(e&&(e.prototype.__name||(e.prototype.__name=c.parent),a.extend(d,e),e.prototype.__onDefine))if(c.onDefine){var h=c.onDefine;c.onDefine=function(a,b,c,d){e.prototype.__onDefine.call(this,a,b,c,d),h.call(this,a,b,c,d)}}else c.onDefine=e.prototype.__onDefine;d.prototype.__construct=c.construct?c.construct:e?e.prototype.__construct:function(){},d.prototype.__defining=!0,g[c.name]=d,f.push(c.name),d.prototype.__class=f.join("."),d.prototype.__name=f.pop(),c.onDefine&&(d.prototype.__onDefine=c.onDefine),c.aliases&&a.alias(d,c.aliases),a.statics(d,c.statics),c.properties&&a.properties(d,c.properties)}var h=[],i=!1,k=0;g.prototype.define=function(c){function g(){var e,f=l.exists(c.parent);if(f&&f.prototype.__defining)setTimeout(g,10);else if(d(j,c,q),c.onDefine&&(e=c.onDefine.apply(q.prototype,[c,p,c.name,q])),e||(e=p[c.name]),c.onReady&&a(document).ready(function(){m.done(function(){c.onReady(e)})}),delete q.prototype.__defining,k--,0===k)for(;h.length;){var i=h.pop();i(a,b)}}var j=this,n=c.require,o=m.getLibrary(c.namespace,!0).resource,p=l.get(l.parse(c.namespace)),q=function(){i||this.__construct.apply(this,arguments[0]instanceof f?arguments[0].args:arguments)};if(k++,!c.name)throw"Need name for class";p[c.name]=new e,n?n.length&&(n={classes:n}):n={},c.parent&&(n.classes?n.classes.push(c.parent):n.classes=[c.parent]),c.aliases&&(n.aliases=c.aliases),m.require(n,g,o)},g.prototype.singleton=function(a){var b=a.onDefine?a.onDefine:function(){};a.onDefine=function(a,c,d,e){var f,g=new e,h=d.charAt(0).toLowerCase()+d.slice(1);return c[h]=g,b.apply(this,[a,c,d,e,g]),a.module&&(f=a.module,f=f.charAt(0).toUpperCase()+f.slice(1).toLowerCase(),j[f]=g),g},this.define(a)},g.prototype.factory=function(a){var b=a.onDefine?a.onDefine:function(){};a.onDefine=function(a,c,d,e){var f={},g=function(){return Array.prototype.push.call(arguments,e),a.factory.apply(f,arguments)};c[d.charAt(0).toLowerCase()+d.slice(1)]=g,b.apply(this,arguments)},this.define(a)},g.prototype.decorator=function(a){var b,d;a.properties||(a.properties={}),b=a.properties._decorate,d=a.construct,delete a.properties._decorate,delete a.construct,a.properties._decorate=function(a,e){var f;d&&(e?c("__construct",a,function(){this._wrapped&&this._wrapped.apply(this,arguments),d.apply(this,arguments)}):d.apply(a));for(f in this)"__construct"!==f&&"_decorate"!==f&&(a[f]?c(f,a,this[f]):a[f]=this[f]);return b&&b.call(a),a},this.singleton(a)},g.prototype.mutate=function(a,b){var c,d,e=a.onDefine?a.onDefine:function(){};if(a.decorators){for(d="string"==typeof a.decorators?d.split(","):a.decorators,a.require?a.require.length&&(a.require={classes:a.require}):a.require={},a.require.classes||(a.require.classes=[]),c=0;c<d.length;c++)a.require.classes.push(d[c]);a.onDefine=function(a,b,c,f){var g,h,i;for(e.apply(this,[a,b,c,f]),g=0,i=d,h=i.length;h>g;g++)l.get(i[g],!0)._decorate(this,!0);for(g in a.noOverride)this[g]=a.noOverride[g]}}b?this.singleton(a):this.define(a)},g.prototype.properties=function(a,b){for(var c in b)a.prototype[c]=b[c]},g.prototype.statics=function(b,c){b.prototype.__static?(b.prototype.__static={},a.extend(b.prototype.__static,c)):b.prototype.__static=c?c:{}},g.prototype.alias=function(a,b){for(var c in b){var d=b[c];a.prototype["__"+d]=l.get(c).prototype}},g.prototype.extend=function(a,b){i=!0,a.prototype=new b,a.prototype.constructor=a,a.prototype[b.prototype.__class]=b.prototype,i=!1},g.prototype.loaded=function(c){k?h.push(c):c(a,b)}}(),b.bMoor={module:j,setTemplate:function(a,b){this.templates[a]=b},templates:{},require:function(){m.require.apply(m,arguments)},get:function(a,b){return l.exists(a,b)},settings:k,autoload:m,constructor:new g}}(jQuery,this),function(a,b){"use strict";var c={};bMoor.constructor.singleton({name:"Resource",namespace:["bmoor","lib"],module:"Resource",onReady:function(a){var b,c=document.getElementsByTagName("script");bMoor.setTemplate=function(b,c){a.setTemplate(b,c)};for(b in bMoor.templates)a.setTemplate(b,bMoor.templates[b]);for(var d=0,e=c.length;e>d;d++){var f=c[d];f.id&&(f.src&&(a.__static.loadedScripts[f.src]=f.id),"text/html"==f.getAttribute("type")&&a.setTemplate(f.id,f.innerHTML))}},statics:{loadedScripts:{}},properties:{loadScriptSet:function(){var a=Array.prototype.slice.call(arguments,0),b=a.pop(),c=a.shift(),d=c,e=function(){$.getScript(c).done(b).fail(function(b,f,g){a.length?(c=a.shift(),e()):error("failed to load file : "+d+"\nError : "+g)})};e()},loadScript:function(a,b,c){var d,e=this;"string"==typeof a&&(a=[a]),d=(c||"")+a.shift(),$.getScript(d).done(function(){a.length?e.loadScript(a,b,c):b()}).fail(function(a,b,c){error("failed to load file : "+d+"\nError : "+c)})},loadStyle:function(a,b){var c,d,e,f=null;d=document.createElement("link"),d.setAttribute("href",a),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.sheet?(e="sheet",c="cssRules",f=setInterval(function(){try{d[e]&&d[e][c]&&d[e][c].length&&(clearInterval(f),b())}catch(a){}},10)):$(d).bind("load",b),$("head").append(d)},loadImage:function(a,b){var c=new Image;"#"==a[0]&&(a=$(a)[0].src),c.onload=b,c.src=a},loadTemplate:function(a,d,e){var f,g=null,h=bMoor.templates;if(e===b&&"string"!=typeof d&&(e=d,d=null),"#"===a[0]&&(a=a.substring(1)),!h[a])if(c[d]){var i=loadedScript[d];h[i]?h[a]=h[i]:this.setTemplate(a,document.getElementById(i).innerHTML)}else if(null!==(f=document.getElementById(a)))this.setTemplate(a,f.innerHTML);else{if(null===d)throw"loadTemplate : "+a+" requested, and not found, while src is null";g=this,$.ajax(d,{success:function(b){g.setTemplate(b),e(h[a])}})}if(null===g){if(!e)return h[a];e(h[a])}return null},parseTemplate:function(a){var b=null;switch(typeof a){case"string":b=a.replace(/\s*<!\[CDATA\[\s*|\s*\]\]>\s*|[\r\n\t]/g,"");break;case"function":b=a.isTemplate?a:a.toString().split(/\n/).slice(1,-1).join("\n")}return b},setTemplate:function(a,b){bMoor.templates[a]=this.parseTemplate(b)}}},!0)}(this),function(){bMoor.constructor.singleton({name:"Bouncer",namespace:["bmoor","lib"],module:"Schedule",construct:function(){this._stack=[],this._done=[],this._pauseAfter=null,this._lock=!1},properties:{runPause:30,runWindow:300,_setTime:function(){this._pauseAfter=(new Date).getTime()+this.runWindow},add:function(a){this._stack.push(a)},done:function(a){this._done.push(a)},_run:function(){if(this._lock=!1,this._stack.length)this.run();else if(this._done.length){for(;this._done.length;)this.add(this._done.shift());this.run()}else this._pauseAfter=null},run:function(){var a,b=this;this._stack.length&&!this._lock?(this._lock=!0,a=this._stack.shift(),0===this.runWindow?(a(),this._run()):(null===this._pauseAfter&&this._setTime(),a(),(new Date).getTime()>this._pauseAfter?setTimeout(function(){b._pauseAfter=null,b._run()},this.runPause):this._run())):this._run()}}})}(jQuery,this),function(){bMoor.constructor.singleton({name:"KeyboardTracker",namespace:["bmoor","lib"],onReady:function(a){$(document.body).on("keydown",function(b){a.activeKeys[b.which]=!0}),$(document.body).on("keyup",function(b){delete a.activeKeys[b.which]})},properties:{activeKeys:{},isDown:function(a){return this.activeKeys[a]}}})}(this),function(){bMoor.constructor.singleton({name:"MouseTracker",namespace:["bmoor","lib"],onReady:function(a){$(document.body).on("mousemove",function(b){a.x=b.pageX,a.y=b.pageY})}})}(this),function(){bMoor.constructor.singleton({name:"WaitFor",namespace:["bmoor","lib"],construct:function(){},require:{references:{"bMoor.module.Resource":["bmoor","lib","Resource"]}},module:"Wait",properties:{_waiting:0,_done:[],_return:function(){var a;for(this._waiting--;this._done.length&&this._waiting<1;)a=this._done.pop(),a()},done:function(a){this._waiting<1?a():this._done.unshift(a)},require:function(a,b){var c=this;return this._waiting++,bMoor.autoload.require(a,function(){b&&b(),c._return()}),this},loadScript:function(a,b){var c=this;return this._waiting++,bMoor.module.Resource.loadScript(a,function(){b&&b(),c._return()}),this},loadStyle:function(a,b){var c=this;return this.waiting++,bMoor.module.Resource.loadStyle(a,function(){b&&b(),c._return()}),this},loadImage:function(a,b){var c=this;return this._waiting++,bMoor.module.Resource.loadImage(a,function(){b&&b(),c._return()}),this},loadTemplate:function(a,b,c){var d=this;return this._waiting++,bMoor.module.Resource.loadTemplate(a,b,function(){c&&c(),d._return()}),this}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Abstract",namespace:["snap","model"],construct:function(a){this._initModel(a),this._initDefaults()},properties:{toObject:function(){var a,b={};for(a in this)this.hasOwnProperty(a)&&"function"!=typeof this[a]&&(b[a]=this[a]);return b},toJson:function(){return JSON.stringify(this.toObject())},set:function(a,b){this._validations[a]?this._validations[a](b)&&(this[a]=b):this[a]=b},_validations:{},_initModel:function(a){var b;for(b in a)a.hasOwnProperty(b)&&this.set(b,a[b])},_initDefaults:function(){var a,b=this._defaults;for(a in b)this[a]||this.set(a,b[a])},_defaults:{}}})}(jQuery,this),function(a,b){var c=0;bMoor.constructor.define({name:"Map",namespace:["snap","observer"],construct:function(a){this.snapid=c++,this.cleaned={},this.listeners=[],this.interval=null,this.root=this,this.init(a)},properties:{init:function(a){this.spy(a),a._=this},spy:function(a){this.model&&this.model._==this&&delete this.model._,this.model=a,this.interval?this.flush({modelSwitch:!0}):this.start()},simplify:function(){var a,b=this.model,c={};for(a in b)b.hasOwnProperty(a)&&"_"!=a[0]&&"$"!=a[0]&&(val=b[a],"function"==typeof val&&(val=b[a]()),c[a]=val);return c},isEmpty:function(){var a,b=this.model;for(a in b)if(b.hasOwnProperty(a)&&"_"!=a[0]&&"$"!=a[0])return!1;return!0},start:function(a){var b=this;return this.interval||(this._clean(),this.flush({start:!0}),this.interval=setInterval(function(){b.flush({})},a||50)),this},stop:function(){return clearInterval(this.interval),this.interval=null,this.flush({stop:!0}),this},flush:function(a){var b,c;if(b=this._clean(),this._needNotify(b)){for(c in a)b[c]=a[c];this._notify(b)}},bind:function(a,b){return this.listeners.push(a),b||this._onBind(a),this},_cleanse:function(){return this.model},_clean:function(){var a,c=this._cleanse(),d={},e=this.cleaned;for(var f in c)if(c.hasOwnProperty(f)&&"_"!=f[0]){if(a=c[f],"function"==typeof a)continue;a!==e[f]&&(d[f]=!0,a===b?delete e[f]:e[f]=a)}return d},_needNotify:function(a){return!$.isEmptyObject(a)},run:function(a,b){a.call(this,b)},_notify:function(a){var b,c,d;for(c=0,b=this.listeners,d=b.length;d>c;c++)this.run(b[c],a);return this},_onBind:function(a){this.run(a,{binding:!0})}}})}(this),function(a,b,c){bMoor.constructor.mutate({name:"Collection",namespace:["snap","observer"],parent:["snap","observer","Map"],construct:function(a){var b=this;this["snap.observer.Map"].__construct.call(this,a),this.removals=[],a.pop=function(){var a=Array.prototype.pop.call(this);return a.$markRemoval===c&&(a.$markRemoval=b.removals.length),b.removals.push(a),a},a.shift=function(){var a=Array.prototype.shift.call(this);return a.$markRemoval===c&&(a.$markRemoval=b.removals.length),b.removals.push(a),a},a.splice=function(){var a,d,e=Array.prototype.splice.apply(this,arguments);for(a=0,d=e.length;d>a;a++)e[a].$markRemoval===c&&(e[a].$markRemoval=b.removals.length+a);return b.removals=b.removals.concat(e),e}},properties:{remove:function(a){var b=this.find(a);return-1!=b?this.model.splice(b,1)[0]:void 0},find:function(a,b){var c,d,e=this.model;if(e.indexOf)return e.indexOf(a,b);for(null===b?b=0:0>b&&(b=Math.max(0,e.length+b)),c=b,d=e.length;d>c;c++)if(e[c]===a)return c;return-1},_clean:function(){var a,b,d,e=this.model,f={},g=this.cleaned,h={};for(d in e)if(e.hasOwnProperty(d)&&"_"!=d[0]){if(b=e[d],"function"==typeof b)continue;a=parseInt(d,10),isNaN(a)?b!=g[d]&&(f[d]=!0,g[d]=b):(b._||new snap.observer.Map(b),b.$remove?this.model.splice(a,1):b._.index===c?h[d]=b:b._.index!=a&&(h[d]=b,b.$markRemoval!==c&&(this.removals[b.$markRemoval]=c,delete b.$markRemoval)),b._.index=a)}return f.removals=this.removals,f.moves=h,this.removals=[],f},_needNotify:function(b){var c;for(c in b)if(b.hasOwnProperty(c))if("removals"==c){if(b.removals.length)return!0}else{if("moves"!=c)return!0;if(!a.isEmptyObject(b.moves))return!0}return!1},_onBind:function(a){this.run(a,{binding:!0,moves:this.model})},run:function(a,b){a.call(this,b)}}})}(jQuery,this),function($,global,undefined){bMoor.constructor.define({name:"Core",namespace:["snap"],require:{classes:[["snap","observer","Map"],["snap","observer","Collection"]]},properties:{getModel:function(){return this.observer?this.observer.model:null},__warn:function(a){this__log("warn",a)},__error:function(a){throw this.__log("error",a),a},__log:function(){Array.prototype.unshift.call(arguments,this.__class+" -> "),console.log.apply(console,arguments)},_initElement:function(a){this.element=a},_initModel:function(){var a=this._findObserver();return a?a.model:global},_observe:function(a){var b=null;return a&&(b=a._?a._:a.length===undefined?new snap.observer.Map(a):new snap.observer.Collection(a)),b},_parseAttributes:function(a){this._attributes=a},_unwrapVar:function(a,b,c){var d,e,f,g=a,h="string"==typeof b?b.split("."):b;if(c){for(e=0,f=h.length;f>e;e++){if(g[h[e]]===undefined)return undefined;d=g,b=h[e],g=g[b]}return{scope:d,value:g,variable:b}}for(e=0,f=h.length;f>e;e++){if(g[h[e]]===undefined)return undefined;g=g[h[e]]}return g},_getAttribute:function(a,b,c){var d;if(this._attributes&&this._attributes[a])d=this._attributes[a];else{if(a="snap-"+a,!this.element.hasAttribute||!this.element.hasAttribute(a))return b;d=this.element.getAttribute(a)}return c?c(d):d},_findElementWithProperty:function(a,b){var c=b||this.element;if(c)for(c.hasAttribute||(c=c[0]);"HTML"!=c.tagName;){if(c[a])return c;c=c.parentNode}return null},_findProperty:function(a,b){var c=this._findElementWithProperty(a,b);return c?c[a]:null},_findRoot:function(a){return this._findProperty("root",a)},_setRoot:function(a){a||(a=this.root),this.element.root=a},_findObserver:function(a){return this._findProperty("observer",a)},_pushObserver:function(a,b){a||(a=this.element),b||(b=this.observer),a.observer=b},_closestNode:function(a){for(var b,c=this.element.parentNode;c&&b===undefined;)c.node&&c.node instanceof a&&(b=c.node),c=c.parentNode;return b},_select:function(a,b){return b||(b=this.element),b.querySelectorAll?b.querySelectorAll(a):$(b).find(a)},_decodeData:function(a){return this._unwrapVar(this.observer.model,a)},_decode:function(variable){return"string"!=typeof variable?variable:"{"==variable[0]||"["==variable[0]?eval(variable):eval("global."+variable)}}})}(jQuery,this),function(a,b,c){var d=!1;bMoor.constructor.singleton({name:"Bootstrap",namespace:["snap","lib"],require:{references:{"bMoor.module.Wait":["bmoor","lib","WaitFor"],"bMoor.module.Schedule":["bmoor","lib","Bouncer"]}},module:"Bootstrap",onReady:function(a){if(!d){var b=a;bMoor.constructor.loaded(function(){d=!0,b.check()})}},construct:function(){this._render.push(function(){document.body.className+=" snap-ready"})},properties:{_stopped:!1,_checking:!1,_booting:0,_render:[],_preRender:null,preRender:function(a){this._preRender=a},done:function(a,b){b===c?(b=a,0===this._booting?b():this._render.push(b)):(this._render[a]===c&&(this._render[a]=[]),this._render[a].push(b))},stop:function(){this._stopped=!0},start:function(){this._stopped=!1,this.check()},check:function(){this._stopped||this._checking||(this._checking=!0,this.build(document.body),this._checking=!1)},_buildNode:function(a,b){var c=this,d=b.getAttribute("snap-node"),e=[],f=[];return b.removeAttribute("snap-node"),b.hasAttribute("snap-visage")&&(f=b.getAttribute("snap-visage").split(","),e=f.slice(0)),e.push(d),{requirements:e,build:function(){var a,e,g,h=bMoor.get(d);if(!h)throw"Bootstrap tried to find node: "+d;try{g=new h(b,{},!0)}catch(i){throw"Bootstrap tried to create node: "+d}for(a=0;a<f.length;a++)bMoor.get(f[a],!0)._decorate(g);if(g.init(),b.id&&c._render[b.id]){for(e=c._render[b.id],a=0;a<e.length;a++)e[a](g);delete c._render[b.id]}}}},_buildController:function(a,b){var c,d=b.getAttribute("snap-controller"),e=[],f=[],g=[];return b.removeAttribute("snap-controller"),b.hasAttribute("snap-stint")&&(g=b.getAttribute("snap-stint").split(","),f=g.slice(0)),c=d.indexOf("("),c>=0&&(e=d.substring(c+1,d.length-1).trim().split(","),d=d.substring(0,c)),f.push(d),{requirements:f,build:function(){var a,c,f=bMoor.get(d);if(!f)throw"Bootstrap tried to find controller: "+d;try{c=new f(b,{},e,!0)}catch(h){throw"Bootstrap tried to create controller: "+d}for(a=0;a<g.length;a++)bMoor.get(g[a],!0)._decorate(c);c.init()}}},build:function(a){var b,c,d,e,f=this,g=bMoor.module.Wait,h=bMoor.module.Schedule,i=[],j=[];if(a.hasAttribute){for(this._booting++,f._preRender&&(f._preRender(),f._preRender=null),a.hasAttribute("snap-controller")&&(d=this._buildController(g,a),j=j.concat(d.requirements),i.unshift(d.build)),e=this.select(a,"[snap-controller]"),b=0,c=e.length;c>b;b++)d=this._buildController(g,e[b]),j=j.concat(d.requirements),i.unshift(d.build);for(a.hasAttribute("snap-node")&&(d=this._buildNode(g,a),j=j.concat(d.requirements),i.unshift(d.build)),e=this.select(a,"[snap-node]"),b=0,c=e.length;c>b;b++)d=this._buildNode(g,e[b]),j=j.concat(d.requirements),i.unshift(d.build);h.done(function(){for(var a;f._render.length;)a=f._render.shift(),a();f._booting--}),g.require(j),g.done(function(){for(;i.length;)h.add(i.pop());h.run()})}},select:function(b,c){return b.querySelectorAll?b.querySelectorAll(c):a(b).find(c)}}})}(jQuery,this),function(){bMoor.constructor.factory({name:"Stream",namespace:["snap","lib"],require:{classes:[["snap","observer","Map"]]},factory:function(a,b){return this[a]||(this[a]=new b),this[a]},construct:function(){this._listeners=[],this._data={}},properties:{pushing:function(a,b){var c,d=this;"object"==typeof b?c=function(a){var c;for(c in a)a.hasOwnProperty(c)&&b[c]&&d.push(b[c],this.model[c])}:b===!0&&(c=function(a){var b;for(b in a)a.hasOwnProperty(b)&&d.push(b,this.model[b])}),c&&(a.bind(c),this.push(a.model))},pulling:function(a,b){var c,d,e=typeof b;d="object"===e?function(c,d){var e=b[c];e&&(a.model[e]=d)}:"function"!==e?function(b,c){a.model[b]=c}:b;for(c in this._data)d(c,this._data[c]);this._listeners.push(d)},pull:function(){var a,b={};for(a in this._data)b[a]=this._data[a];return b},push:function(a,b){var c,d,e;if(this._data[a]=b,2==arguments.length)for(d=0,c=this._listeners,e=c.length;e>d;d++)c[d](a,b);else for(d in a)this.push(d,a[d])}}})}(this),function(){bMoor.constructor.define({name:"Abstract",namespace:["snap","service"],require:[["snap","model","Abstract"]],construct:function(){var a;if(null!==this.instanceClass&&"function"!=typeof this.instanceClass){if(a=bMoor.get(this.instanceClass),!a)throw this.__class+" could not find "+this.instanceClass;this.instanceClass=a}},properties:{instanceClass:null,parseService:function(a){return new Function("model",'return "'+a.replace(/:([^\/?&]+)/g,'"+model.$1+"')+'";')},_get:function(){return[]},get:function(){var a,b,c,d=this.instanceClass;if(!this.data){if(c=this._get(),d)for(a=0,b=c.length;b>a;a++)c[a]=new d(c[a]);this.data=c}return this.data},push:function(a){var b=this.instanceClass;b?this.data.push(new b(a)):this.data.push(a)},wrap:function(a){var b=this.instanceClass;return b?new b(a):a}}})}(jQuery,this),function(){bMoor.constructor.decorator({name:"Decorator",namespace:["snap","templating"],require:{references:{"bMoor.module.Resource":["bmoor","lib","Resource"]}},properties:{prepared:{},get:function(a,b,c){return this.run(this.prepare(a,c),b)},prepare:function(a,b){var c,d=typeof a;return"string"==d?b?a.isTemplate?a:(c=this._wrapped(a),c.isTemplate=!0,c):(this.prepared[a]||(c=this._wrapped(bMoor.module.Resource.loadTemplate(a)),c.isTemplate=!0,this.prepared[a]=c),this.prepared[a]):"function"==d?a:void 0}}})}(jQuery,this),function(a){function b(b,c){throw a.extend(b,c),b}function c(a){var b=[];if(n.call(a)!==h)return!1;for(var c=0,d=a.length;d>c;c++)b[c]=a[c].jqote_id;return b.length?b.sort().join(".").replace(/(\b\d+\b)\.(?:\1(\.|$))+/g,"$1$2"):!1}function d(b,c){var e,f=[],c=c||l,g=n.call(b);if(g===j)return b.jqote_id?[b]:!1;if(g!==h)return[a.jqotec(b,c)];if(g===h)for(var i=0,k=b.length;k>i;i++)(e=d(b[i],c))&&f.push(e[0]);return f.length?f:!1}var e="UndefinedTemplateError",f="TemplateCompilationError",g="TemplateExecutionError",h="[object Array]",i="[object String]",j="[object Function]",k=1,l="%",m=/^[^<]*(<[\w\W]+>)[^>]*$/,n=Object.prototype.toString;a.fn.extend({jqote:function(b,c){var d="";return this.each(function(e){var f=a.jqotec(this,c);d+=f.call(b,e,0,b,f)}),d}}),a.each({app:"append",pre:"prepend",sub:"html"},function(b,e){a.fn["jqote"+b]=function(f,g,h){var i,j,k=a.jqote(f,g,h),l=m.test(k)?a:function(b){return a(document.createTextNode(b))};return(i=c(d(f)))&&(j=new RegExp("(^|\\.)"+i.split(".").join("\\.(.*)?")+"(\\.|$)")),this.each(function(){var c=l(k);a(this)[e](c),(3===c[0].nodeType?a(this):c).trigger("jqote."+b,[c,j])})}}),a.extend({jqote:function(a,c,f){var g="",f=f||l,h=d(a,f);h===!1&&b(new Error("Empty or undefined template passed to $.jqote"),{type:e});for(var i=0,j=h.length;j>i;i++)g+=h[i].call(c,i,0,c,h[i]);return g},jqotec:function(c,d){var h,j,o,d=d||l,p=n.call(c);if(p===i&&m.test(c)){if(j=o=c,h=a.jqotecache[c])return h}else if(j=p===i||c.nodeType?a(c):c instanceof jQuery?c:null,j[0]&&((o=j[0].innerHTML)||(o=j.text()))||b(new Error("Empty or undefined template passed to $.jqotec"),{type:e}),h=a.jqotecache[a.data(j[0],"jqote_id")])return h;for(var q,r="",s=o.replace(/\s*<!\[CDATA\[\s*|\s*\]\]>\s*|[\r\n\t]/g,"").split("<"+d).join(d+">").split(d+">"),t=0,u=s.length;u>t;t++)r+=""!==s[t].charAt(0)?"out+='"+s[t].replace(/(\\|["'])/g,"\\$1")+"'":"="===s[t].charAt(1)?";out+=("+s[t].substr(2)+");":"!"===s[t].charAt(1)?";out+=$.jqotenc(("+s[t].substr(2)+"));":";"+s[t].substr(1);r="try{"+('var out="";'+r+";return out;").split("out+='';").join("").split('var out="";out+=').join("var out=")+'}catch(e){e.type="'+g+'";e.args=arguments;e.template=arguments.callee.toString();throw e;}';try{var v=new Function("i, j, data, fn",r)}catch(w){b(w,{type:f})}return q=j instanceof jQuery?a.data(j[0],"jqote_id",k):j,a.jqotecache[q]=(v.jqote_id=k++,v)},jqotefn:function(b){var c=n.call(b),d=c===i&&m.test(b)?b:a.data(a(b)[0],"jqote_id");return a.jqotecache[d]||!1},jqotetag:function(a){n.call(a)===i&&(l=a)},jqotenc:function(a){return a.toString().replace(/&(?!\w+;)/g,"&#38;").split("<").join("&#60;").split(">").join("&#62;").split('"').join("&#34;").split("'").join("&#39;")},jqotecache:{}}),a.event.special.jqote={add:function(a){var b,e=a.handler,f=a.data?n.call(a.data)!==h?[a.data]:a.data:[];a.namespace||(a.namespace="app.pre.sub"),f.length&&(b=c(d(f)))&&(a.handler=function(a,c,d){return!d||d.test(b)?e.apply(this,[a,c]):null})}}}(jQuery),function(a){bMoor.constructor.mutate({name:"JQote",namespace:["snap","templating"],require:{references:{"jQuery.fn.jqote":["jquery","jqote2"]}},module:"Templator",decorators:[["snap","templating","Decorator"]],construct:function(){a.jqotetag(bMoor.settings.templatorTag)},properties:{get:function(a,b){return this.run(this.prepare(a),b)},prepare:function(b){var c=typeof b;return"string"==c?a.jqotec(b):"function"==c?b:void 0},run:function(b,c){return a.jqote(b,c)}}},!0)}(jQuery,this),function(a){var b=0;bMoor.constructor.define({name:"Basic",namespace:["snap","node"],parent:["snap","Core"],require:{classes:[["snap","observer","Map"],["snap","observer","Collection"]],references:{"bMoor.module.Templator":["snap","templating","JQote"],"bMoor.module.Bootstrap":["snap","lib","Bootstrap"]}},onDefine:function(a){var b;a.node&&(b=a.node,b.className&&(this.className=b.className,this.baseClass=this.baseClass?b.singleClass?b.className:b.className+" "+this.baseClass:b.className))},node:{className:"node-basic"},construct:function(a,b,c){this._parseAttributes(b),c?this.element=a:this.init(a)},properties:{defaultController:null,init:function(a){if(a||(a=this.element),this.classBindings=[],this.makeClass=null,this.observing=!1,this.nodeId=b++,this.$=this._initElement(a),!this.$)throw this.__class+" forgot to return a jQuery object";this.$.data("node",this),a.node=this,this.observer=this._observe(this._initModel()),this._bind(),this._finalize()},_initElement:function(b){var c,d,e=this;if(!b)throw this.__class+" was never passed an element";if(this["snap.Core"]._initElement.call(this,b),!b.controller&&this.defaultController){if(c=bMoor.get(this.defaultController),!c)throw"defaultController could not be found for node ("+this.__class+") : "+this.defaultController;new c(b)}return d=this._getAttribute("class"),d?(b.origClassName=b.className,this.makeClass=new Function("model",'return "'+d.replace(/\{\{([^\?]+)\?([^:]+):([^\}]+)\}\}/g,function(a,b,c,d){return e.classBindings.push(b),'"+(model.'+b+'?"'+c+'":"'+d+'")+"'}).replace(/\{\{([^\/?&]+)\}\}/g,function(a,b){return e.classBindings.push(b),'"+model.'+b+'+"'})+'";')):b.className=this.baseClass+" "+b.className,a(b)},_initModel:function(){var a,b,c,d=this["snap.Core"]._initModel.call(this);if(!this.element.controller)if(a=this._getAttribute("observe")){if(c=a.split("."),b=this._unwrapVar(d,c,!0),b.value instanceof snap.observer.Map)d=b.value.model;else{if("object"!=typeof b.value)throw"Trying to observe, but no observer.Map found";d=b.scope,this.variable=b.variable}this.observing=!0}else a=this._getAttribute("scope",this.element.name),a&&(c=a.split("."),b=this._unwrapVar(d,c,!0),b&&("object"==typeof b.value?(this.variable=null,d=b.value):(this.variable=b.variable,d=b.scope)));return d},_bind:function(){var a=this;this.viewBindings=this._makeBindings(),this.observer.bind(function(b){a._needUpdate(b)&&a._prepContent(this.model,b),a._onAlteration(this.model,b),a.makeClass&&a._needClassUpdate(b)&&a._updateClass(this.model)})},_onAlteration:function(){},_makeBindings:function(){var a=this._getAttribute("binding");return a?"-"==a[0]?[]:"*"==a[0]?null:a.split(","):this.variable?[this.variable]:[]},_needClassUpdate:function(a){var b,c,d=!1,e=this.classBindings;if(a.binding)return!0;for(b=0,c=e.length;c>b&&!d;b++)d=a[e[b]];return d},_updateClass:function(a){var b=this.element;b.className=this.baseClass+" "+b.origClassName+" "+this.makeClass(a)},_needUpdate:function(a){var b,c,d,e=this.viewBindings;if(a.binding)return!0;if(e)for(d=!1,b=0,c=e.length;c>b&&!d;b++)d=a[e[b]];else d=!0;return d},_prepContent:function(a,b){var c=this;this.variable?(value=a[this.variable],"function"==typeof value&&(value=a[this.variable]())):value=a,this._pushObserver(this.element,this.observing?this._observe(value):this.observer),this._makeContent(value,b)&&bMoor.module.Bootstrap.done(function(){c._finalizeContent()})},_makeContent:function(){return!0},_finalizeContent:function(){},_finalize:function(){}}})}(jQuery,this),function(){bMoor.constructor.define({name:"View",namespace:["snap","node"],parent:["snap","node","Basic"],references:{"bMoor.module.Templator":["snap","templating","JQote"]},node:{className:"node-view"},onDefine:function(){var a;if(this.templates)for(a in this.templates)this.templates[a]=bMoor.module.Templator.prepare(bMoor.module.Resource.parseTemplate(this.templates[a]),!0)},properties:{defaultTemplate:null,findTemplate:function(a){for(var b,c=this.element;c;){if(b=c.node,b.templates&&b.templates[a])return b.templates[a];c=this._findElementWithProperty("node",c.parentNode)}},_makeTemplate:function(a){var b;if(b=this._getAttribute("template")){if(">"==b.charAt(0)?(this.watchTemplateVar=b.substring(1),b=this._unwrapVar(a,b.substring(1))):"$"==b.charAt(0)&&(b=this._unwrapVar(this.templates,b.substring(1))),b)return this.findTemplate(b)||bMoor.module.Templator.prepare(b);throw this.__class+" tried to generate template from attribute, but failed"}if(this.defaultTemplate){if((b=this.findTemplate(this.defaultTemplate))&&b.isTemplate)return b;
throw this.__class+" tried to generate template from defaultTemplate, but failed"}return null},_makeContent:function(a){var b=this._makeTemplate(a);return b?(this._setContent(bMoor.module.Templator.run(b,a)),!0):!1},_setContent:function(a){var b,c,d=document.createElement("div");for(d.innerHTML=a,this.element.innerHTML="",c=d.firstChild;c;)b=c.nextSibling,this.element.appendChild(c),this._finalizeElement(c),c=b},_needUpdate:function(a){return this.watchTemplateVar&&a[this.watchTemplateVar]||this["snap.node.Basic"]._needUpdate.call(this,a)},_finalizeElement:function(a){3!=a.nodeType&&bMoor.module.Bootstrap.build(a)}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Text",namespace:["snap","node"],parent:["snap","node","Basic"],node:{className:"node-text"},properties:{_makeContent:function(a){this.element.innerHTML=String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Debug",namespace:["snap","node"],parent:["snap","node","Basic"],node:{singleClass:!0,className:"node-debug"},properties:{_makeContent:function(a){this.element.innerHTML=JSON.stringify(a._simplify?a._simplify():a)}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Script",namespace:["snap","node"],parent:["snap","node","Basic"],node:{singleClass:!0,className:"node-script"},properties:{_makeContent:function(a){var b=document.createElement("script");b.text=a,this.element.parentNode.insertBefore(b,this.element),this.element.parentNode.removeChild(this.element),this.element=b}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Style",namespace:["snap","node"],parent:["snap","node","Basic"],node:{singleClass:!0,className:"node-style"},properties:{_makeContent:function(a){this.element.styleSheet?this.element.styleSheet.cssText=a:(this.element.innerHTML="",this.element.appendChild(document.createTextNode(a)))}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Switch",namespace:["snap","node"],parent:["snap","node","View"],properties:{_makeTemplate:function(a){var b;return a&&(b=this._unwrapVar(a,this._getAttribute("template")),b?this.watchTemplateVar=this._getAttribute("template"):b=this._getAttribute("defaultTemplate"),b)?bMoor.module.Templator.prepare(b):null},_needUpdate:function(a){return a.modelSwitch||this["snap.node.View"]._needUpdate.call(this,a)}}})}(jQuery,this),function(a){bMoor.constructor.define({name:"List",namespace:["snap","node"],parent:["snap","node","View"],require:[["snap","observer","Collection"]],node:{className:"node-list"},properties:{_initElement:function(a){var b=this["snap.node.View"]._initElement.call(this,a);return this.rows={},this.isTable="TABLE"==a.tagName,this.mountPoint=null,b},_makeTemplate:function(){var a;return this.mountPoint||(a=this.$.find("[mount]")[0],this.mountPoint=a?{base:a}:{base:this.isTable?this.element.getElementsByTagName("tbody")[0]:this.element},a=this.$.find("[mountBelow]")[0],a?(this.mountPoint.top=a,a.nextSibling&&(this.mountPoint.bottom=a.nextSibling)):(a=this.$.find("[mountAbove]")[0],a&&(this.mountPoint.bottom=a,a.previousSibling&&(this.mountPoint.top=a.previousSibling))),a&&a.parentNode!=this.mountPoint.base&&(this.mountPoint.base=a.parentNode)),this["snap.node.View"]._makeTemplate.call(this)},_needUpdate:function(b){return b.binding||b.removals&&b.removals.length||!a.isEmptyObject(b.moves)},_makeContent:function(b,c){var d,e,f,g,h,i,j,k=this._makeTemplate(b);if(b._ instanceof snap.observer.Collection){if(j=c.removals)for(d in j)if(g=j[d],"object"==typeof g){for(h=this.rows[g._.snapid],d=0,e=h.length;e>d;d++)f=h[d],f.parentNode&&f.parentNode.removeChild(f);delete this.rows[g._.snapid]}for(i=c.moves,d=0,e=b.length;e>d;d++)i[d]&&this.insert(i[d],k,b[d-1])}else for(a(this.mountPoint.base).empty(),d=0,e=b.length;e>d;d++)this.append(b[d],k,null)},_makeChildren:function(a,b){var c=document.createElement(this.isTable?"table":"div");return c.innerHTML=bMoor.module.Templator.run(b,a),this.isTable?c.getElementsByTagName("tbody")[0]:c},add:function(a){this.observer.model.push(a)},append:function(a,b){var c,d,e=this._makeChildren(a,b);for(d=e.firstChild;d;)c=d.nextSibling,this._append(d),this._finalizeElement(d),d=c;return e},insert:function(a,b,c){var d,e,f,g,h,i,j=a._;if(g=this.rows[a._.snapid],!g)for(h=this._makeChildren(a,b),g=this.rows[a._.snapid]=[],i=h.firstChild;i;)this._pushObserver(i,j),g.push(i),i=i.nextSibling;for(c&&(f=this.rows[c._.snapid])?(c=f[f.length-1],g.previous=f):c=this.mountPoint.top,d=0,e=g.length;e>d;d++)i=g[d],this._insert(i,c),this._finalizeElement(i),c=i;return h},_append:function(a){3!=a.nodeType&&(this.mountPoint.bottom?this.mountPoint.top?this.mountPount.base.insertBefore(a,this.mountPoint.bottom):this.mountPoint.base.insertBefore(a,this.mountPoint.base.firstChild):this.mountPoint.base.appendChild(a))},_insert:function(a,b){3!=a.nodeType&&(b?b.nextSibling?b.parentNode.insertBefore(a,b.nextSibling):b.parentNode.appendChild(a):this.mountPoint.base.insertBefore(a,this.mountPoint.base.firstChild))}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Basic",namespace:["snap","node","input"],parent:["snap","node","Basic"],properties:{lockValue:function(){},val:function(){},_isValid:function(){return null},_makeContent:function(a){this.val(a)},_initElement:function(a){return this.root=this._findRoot(a),this["snap.node.Basic"]._initElement.call(this,a)},_initModel:function(){var a=this["snap.node.Basic"]._initModel.call(this);return!this.variable&&this.element.name?this.variable=this.element.name:this.variable&&!this.element.name&&this.element.setAttribute("name",this.variable),a},_bind:function(){this["snap.node.Basic"]._bind.call(this),this.lockValue(),this._listen()},_listen:function(){var a=this,b=this.element;b.onchange=function(){a._onChange()}},_onChange:function(){var a=this.root.observer.model,b=this.val(),c=this._isValid(b);this._pushChange(),b==this.lockedValue?this.clearState():(c===!1?this.setState(!1):c===!0&&this.setState(!0),a.$addChange&&a.$addChange(this))},_pushChange:function(){this.observer.model[this.element.name]=this.val()},setState:function(a){var b=this.root.observer.model;a?(b.$removeError&&b.$removeError(this),this.$.removeClass("state-error"),this.$.addClass("state-valid")):(b.$addError&&b.$addError(this),this.$.addClass("state-error"),this.$.removeClass("state-valid"))},clearState:function(){this.$.removeClass("state-error"),this.$.removeClass("state-valid")}}})}(jQuery,this),function(a,b,c){bMoor.constructor.define({name:"Text",namespace:["snap","node","input"],parent:["snap","node","input","Basic"],properties:{_listen:function(){var a=this,b=this.element;b.onkeyup=function(){a._onChange()},b.onchange=function(){a._onChange()}},lockValue:function(){var a=this.val();this.lockedValue=a,this.element.setAttribute("value",this.val())},val:function(a){return a===c&&(a=""),arguments.length?(this.element.value=a,void 0):this.element.value}}})}(jQuery,this),function(a,b,d){bMoor.constructor.define({name:"Checked",namespace:["snap","node","input"],parent:["snap","node","Basic"],properties:{_initElement:function(a){var b,c,d=a.nodeName?a.name:a[0].name;if(this.checked=[],this.map={},this.multi=!1,"]"==d[d.length-1]&&(d=d.substring(0,d.length-2),"checkbox"==a[0].type.toLowerCase()&&(this.multi=!0)),this.name=d,!a.nodeName)for(c=0;c<a.length;c++)b=a[c],this.map[b.value]=b,b.checked&&this.checked.push(b);return this["snap.node.Basic"]._initElement.call(this,a)},_initModel:function(a){var b=this["snap.node.Basic"]._initModel.call(this,a);return this.variable||(this.variable=this.name),b},_makeContent:function(a){this.val(a)},_bind:function(){var a=this;this["snap.node.Basic"]._bind.call(this),this.observer&&this.variable&&this.alter(function(b){a.observer.model[a.name]=b})},val:function(a){var b,e,f,g=this.element;if(!a){if(g.nodeName)return g.checked?g.value:null;if(this.multi){var h=[];for(b=0,c=g.length;c>b;b++)e=g[b],e.checked&&h.push(e.value);return h}for(b=g.length-1;b>=0;b--)if(e=g[b],e.checked)return e.value;return null}if(g.nodeName)g.checked=g.value==a?!0:!1;else{for(f=this.checked,this.checked=[],b=0;b<f.length;b++)f[b].checked=!1;if(this.multi)for((a.length===d||"string"==typeof a)&&(a=[a]),b=0;b<a.length;b++)e=this.map[a[b]],e&&(this.checked.push(e),e.checked=!0);else a.length&&"string"!=typeof a&&(a=a.pop()),e=this.map[a],e&&(this.checked.push(e),e.checked=!0)}},alter:function(a){var b=this,c=function(){a(b.val())};if(this.element.nodeName)this.element.onchange=c;else for(var d=0,e=this.element.length;e>d;d++)this.element[d].onchange=c}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Checkbox",namespace:["snap","node","input"],parent:["snap","node","input","Basic"],properties:{val:function(a){var b=this.element;return a?(b.checked=b.value==a?!0:!1,void 0):b.checked?b.value:null},lockValue:function(){this.element.checked?this.element.setAttribute("checked",!0):this.element.removeAttribute("checked")}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Button",namespace:["snap","node","input"],parent:["snap","node","input","Basic"],properties:{_listen:function(){var a=this,b=this.element;b.onclick=function(){a._onChange()}},val:function(a){return a?(this.element.value==a?this.$.addClass("active"):this.$.removeClass("active"),void 0):this.element.value}}})}(jQuery,this),function(a,b,c){bMoor.constructor.decorator({name:"Disabled",namespace:["snap","node","input"],properties:{_needUpdate:function(a){return a.$isValid||this._wrapped(a)},_makeContent:function(a){var b=this.root.observer.model;this._wrapped(a),b.$isValid!==c&&(this.element.disabled=!b.$isValid)}}})}(jQuery,this),function(){bMoor.constructor.decorator({name:"Required",namespace:["snap","node","input"],properties:{_isValid:function(a){return this._wrapped(a)!==!1?""!==a:!1}}})}(jQuery,this),function(){bMoor.constructor.define({name:"Select",namespace:["snap","node","input"],parent:["snap","node","input","Basic"],properties:{_initElement:function(a){var b,c,d,e=this["snap.node.input.Basic"]._initElement.call(this,a);if(b=this._select("[selected]",a),b.length){for(c=0,d=b.length;d>c;c++)b[c].removeAttribute("selected");b=b[b.length-1]}else b=a.options[0];return this.val(b.value),e},lockValue:function(){this.oldOption&&this.oldOption.removeAttribute("selected"),this.oldOption=this.element.options[this.element.selectedIndex],this.oldOption.setAttribute("selected",!0)},val:function(a){if(!a)return this.element.options[this.element.selectedIndex].value;for(var b,c=this.element.options,d=0,e=c.length;e>d;d++)c[d].value==a&&(b=d,d=e);b||(b=0),this.element.selectedIndex=b}}})}(jQuery,this),function(){bMoor.constructor.decorator({name:"Validation",namespace:["snap","node","input"],construct:function(){var a;a=this._getAttribute("min"),a&&(this.minVal=parseInt(a,10)),a=this._getAttribute("max"),a&&(this.maxVal=parseInt(a,10)),a=this._getAttribute("match"),a&&(this.regEx=new RegExp(a)),a=this._getAttribute("delay"),this.validationDelay=a?a:0},properties:{_onChange:function(){var a=this,b=this._wrapped;this.validationTimeout&&clearTimeout(this.validationTimeout),this.validationTimeout=setTimeout(function(){a.validationTimeout=null,b.call(a)},this.validationDelay)},_isValid:function(a){var b,c=!0;return this._wrapped(a)!==!1?(b=parseInt(a,10),this.maxVal&&(b>this.maxVal||isNaN(b))&&(c=!1),this.minVal&&(b<this.minVal||isNaN(b))&&(c=!1),this.regEx&&!this.regEx.test(""+a)&&(c=!1),c):!1}}})}(jQuery,this),function(){bMoor.constructor.decorator({name:"Form",namespace:["snap","node"],require:[["snap","node","input","Text"],["snap","node","input","Checked"],["snap","node","input","Button"],["snap","node","input","Select"]],node:{className:"node-form"},properties:{_finalizeContent:function(){var a=this.element,b={},c=[];this._wrapped(),elements=a.elements;for(var d=0,e=elements.length;e>d;d++)b[elements[d].name]=!0;for(var f in b){var g,h,i=elements[f];"]"==f[f.length-1]&&(f=f.substring(0,f.length-2)),c.push(f),g=i instanceof NodeList?i[0]:i,g.node||(h="BUTTON"==g.nodeName?new snap.node.input.Button(i):"SELECT"==g.nodeName?new snap.node.input.Select(i):"checkbox"==g.type||"radio"==g.type?new snap.node.input.Checked(i):"button"==g.type?new snap.node.input.Button(i):new snap.node.input.Text(i))}}}})}(jQuery,this),function(a){bMoor.constructor.define({name:"Abstract",namespace:["snap","controller"],parent:["snap","Core"],require:{classes:[["snap","lib","Stream"]]},onDefine:function(b){var c;b.controller?(c=b.controller,this._streamPull=c.streamPull||{},this._streamPush=c.streamPush||{},c.className||(c.className="snap-controller"),this.className=c.className,this.baseClass=this.baseClass?c.singleClass?c.className:c.className+" "+this.baseClass:c.className,a(document).ready(function(){var b,d,e,f="."+c.className.split(" ")[0],g={},h=function(b,c){a(document.body).on(b,function(b){a(f).each(function(){this.controller[c](b,g)})})},i=function(b,c,d){a(document.body).on(b,f+" "+c,function(b){var c,e;return e=snap.Core.prototype._findElementWithProperty("observer",this),c=a(e).hasClass(f)?e:a(this).closest(f)[0],c.controller[d](b,this,e.observer,c.node,g)})};for(e in c.actions)if(d=c.actions[e],"string"==typeof d)i(e,"",d);else for(b in d)i(e,b,d[b]);for(e in c.globals)h(e,c.globals[e])})):(this._streamPull={},this._streamPush={})},construct:function(a,b,c,d){this._parseAttributes(b),this._parseArguments.apply(this,arguments),d?this.element=a:this.init(a)},properties:{init:function(a){var b=this,c=function(a){snap.lib.stream(d).pulling(b.observer,function(){a.apply(b,arguments)})};a||(a=this.element),this._initElement(a),this.observer=this._observe(this._initModel()),this._pushObserver(this.element,this.observer);for(var d in this._streamPush)snap.lib.stream(d).pushing(this.observer,this._streamPush[d]);for(d in this._streamPull)"function"==typeof this._streamPull[d]?c(this._streamPull[d]):snap.lib.stream(d).pulling(this.observer,this._streamPull[d]);this.root=this._findRoot()||this,this._newRoot?this._setRoot(this):this._setRoot(),this._finalize()},_key:null,_newRoot:!1,_parseArguments:function(){this.args=arguments},_model:function(a){return a},_initModel:function(){var a,b,c=this["snap.Core"]._initModel.call(this);return b=this._getAttribute("scope",this.element.name),b&&(b=b.split("."),a=this._unwrapVar(c,b,!0),a&&("object"==typeof a.value?(this.variable=null,c=a.value):(this.variable=a.variable,c=a.scope))),this._model(c)},_initElement:function(a){this["snap.Core"]._initElement.call(this,a),a.controller=this,this.baseClass&&(a.className+=" "+this.baseClass)},_finalize:function(){}}})}(jQuery,this),function(a,b,c){bMoor.constructor.decorator({name:"Form",namespace:["snap","controller"],properties:{_delay:null,_finalize:function(){var b=a(this.element),d=this,e={},f=this.observer.model,g={},h=0;f.$isValid===c&&(f.$errors=[],f.$messages=[],f.$isValid=!1,f.$addError=function(a){g[a.nodeId]||(h++,g[a.nodeId]=!0,this.$isValid=!1)},f.$removeError=function(a){g[a.nodeId]&&(h--,delete g[a.nodeId],h||(this.$isValid=!0))},f.$addChange=function(a){e[a.nodeId]=a,0===h&&(this.$isValid=!0)},f.$appoveChanges=function(){var a;for(a in e)e.hasOwnProperty(a)&&(e[a].lockValue(),e[a].clearState())}),b.on("click",'button[type="reset"]',function(){var a;for(a in e)e.hasOwnProperty(a)&&e[a].clearState();setTimeout(function(){b.find(":input").each(function(){this.onchange&&this.onchange()})},10)}),b.on("submit",function(){return f.$errors=[],f.$messages=[],d.sendPush(function(){0===f.$errors.length&&(f.$appoveChanges(),f.$isValid=!1)}),!1})}}})}(jQuery,this),function(){bMoor.constructor.decorator({name:"Serviced",namespace:["snap","controller"],onDefine:function(a){var b;if(a.services){this.services||(this.services={});for(b in a.services)this.services[b]=bMoor.get(a.services[b])}},properties:{_finalize:function(){this.updates={},this.removes={},this.creates={},this.observer instanceof snap.observer.Collection?this._bindCollection(this.observer):this.observer&&this._bindMap(this.observer),this._wrapped()},_delay:2e3,_bindMap:function(a){var b=a.model,c=this._key;c?b[c]?this._register(a):this._create(a):this._register(a)},_bindCollection:function(a){var b=this;a.bind(function(a){var c,d,e,f;if(e=a.additions,f=a.removals)for(c=0,d=f.length;d>c;c++)b._remove(f[c]._);if(e)for(c=0,d=e.length;d>c;c++)b._bindMap(e[c]._)})},_sendCreate:function(a,b){b()},_sendUpdate:function(a,b){b()},_sendRemove:function(a,b){b()},_get:function(){},_register:function(a){var b=this;a.bind(function(a){b._update(this,a)},!0)},_create:function(a){var b=this;this._register(a),a.run(function(){b.creates[this.snapid]=this}),this._push()},_update:function(a){this.updates[a.snapid]=a,this._push()},_remove:function(a){this.removes[a.snapid]=a,this._push()},_push:function(){var a=this;this._delay&&(this._pushLock&&clearTimeout(this._pushLock),this._pushLock=setTimeout(function(){a._pushLock=null,a.sendPush()},this._delay))},sendPush:function(a){function b(){d--,!d&&a&&a()}var c,d=1,e=this.creates,f=this.removes,g=this.updates;this.creates={},this.removes={},this.updates={};for(c in e)f[c]||(d++,this._sendCreate(e[c],b)),delete f[c],delete g[c];for(c in g)f[c]||(d++,this._sendUpdate(g[c],b));for(c in f)d++,this._sendRemove(f[c],b);b()}}})}(jQuery,this);